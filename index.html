<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIX Trading Signals - Simple Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .status-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .status-item {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            padding: 10px 20px;
            border-radius: 25px;
            color: white;
            font-weight: 600;
        }
        
        .main-signal {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            text-align: center;
        }
        
        .signal-status {
            font-size: 3em;
            font-weight: 700;
            margin-bottom: 10px;
            padding: 20px;
            border-radius: 15px;
            display: inline-block;
        }
        
        .signal-wait {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
        }
        
        .signal-prepare {
            background: linear-gradient(135deg, #ffd93d, #f39c12);
            color: white;
            animation: pulse 2s infinite;
        }
        
        .signal-enter {
            background: linear-gradient(135deg, #00d4aa, #00b894);
            color: white;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .metric-card.triggered {
            box-shadow: 0 0 30px rgba(255,71,87,0.5);
            animation: alertBlink 1s infinite;
        }
        
        @keyframes alertBlink {
            0%, 100% { border: 2px solid transparent; }
            50% { border: 2px solid #ff4757; }
        }
        
        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .metric-title {
            font-weight: 600;
            color: #333;
        }
        
        .metric-tier {
            font-size: 0.75em;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .tier-1 { background: #ff4757; color: white; }
        .tier-2 { background: #00d4aa; color: white; }
        .tier-3 { background: #74b9ff; color: white; }
        
        .metric-value {
            font-size: 2.5em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .metric-status {
            font-size: 0.9em;
            padding: 5px 10px;
            border-radius: 8px;
            display: inline-block;
        }
        
        .status-normal {
            background: #e8f5e8;
            color: #27ae60;
        }
        
        .status-warning {
            background: #fff3cd;
            color: #f39c12;
        }
        
        .status-triggered {
            background: #ffebee;
            color: #e74c3c;
            font-weight: 600;
        }
        
        .alerts-section {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .alert-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #e74c3c;
        }
        
        .alert-icon {
            font-size: 1.5em;
        }
        
        .loading {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-msg {
            background: #ff4757;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .telegram-setup {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .telegram-button {
            background: #0088cc;
            color: white;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            display: inline-block;
            margin-top: 15px;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8em; }
            .metrics-grid { grid-template-columns: 1fr; }
            .signal-status { font-size: 2em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìà VIX Trading Signals Dashboard</h1>
            <p>Real-time monitoring with automatic calculations</p>
        </div>
        
        <div class="status-bar">
            <div class="status-item">
                <span id="marketStatus">Checking Market...</span>
            </div>
            <div class="status-item">
                Last Update: <span id="lastUpdate">Loading...</span>
            </div>
            <div class="status-item">
                Auto-refresh: <span id="refreshCountdown">60s</span>
            </div>
        </div>
        
        <div class="main-signal">
            <h2>Trading Signal</h2>
            <div class="signal-status signal-wait" id="mainSignal">
                LOADING DATA...
            </div>
            <p style="margin-top: 15px; color: #666;">
                Active Signals: <strong id="activeCount">0</strong> / 9 | 
                Confluence: <strong id="confluenceLevel">LOW</strong>
            </p>
        </div>
        
        <div class="metrics-grid" id="metricsGrid">
            <!-- Metrics will be populated here -->
        </div>
        
        <div class="alerts-section">
            <h3 style="margin-bottom: 20px;">üîî Active Alerts</h3>
            <div id="alertsList">
                <div class="alert-item">
                    <div class="alert-icon">‚ÑπÔ∏è</div>
                    <div>Loading market data...</div>
                </div>
            </div>
        </div>
        
        <div class="telegram-setup">
            <h3>üì± Get Alerts on Telegram</h3>
            <p>Want instant alerts when signals trigger? Set up Telegram notifications!</p>
            <a href="https://t.me/BotFather" target="_blank" class="telegram-button">Setup Telegram Bot</a>
            <p style="margin-top: 15px; font-size: 0.9em; color: #666;">
                Bot will alert you when 2+ Tier 1 signals activate
            </p>
        </div>
    </div>
    
    <script>
        // Configuration
        const WATCHLIST_URL = 'https://www.investing.com/portfolio/?portfolioID=NDcyZ245NWAxbmFtNGQ2PQ%3D%3D';
        const REFRESH_INTERVAL = 60000; // 1 minute
        let refreshTimer = 60;
        
        // Signal thresholds from your infographic
        const THRESHOLDS = {
            vix: { low: 12, normal: 18, warning: 20, elevated: 25, critical: 30 },
            vix9dRatio: { signal: 1.10, normal: [0.80, 1.20] },
            skew: { normal: [100, 130], warning: 145, critical: 150 },
            pcRatio: { greed: 0.72, normal: [0.7, 1.2], fear: 1.23 },
            tick: { normal: [-300, 200], signal: -1000 },
            trin: { normal: [0.8, 1.2], warning: 1.5, signal: 2.0 },
            dix: { bearish: 0.35, normal: [0.35, 0.45], bullish: 0.45 },
            hygLqd: { normal: 1.03, warning: 1.06 },
            advDecline: { signal: 0.30, normal: [0.40, 0.60] }
        };
        
        // Current market data
        let marketData = {};
        let alerts = [];
        
        // Fetch data using free APIs (CORS-friendly)
        async function fetchMarketData() {
            try {
                // Using Yahoo Finance API (free, no CORS issues)
                const symbols = ['^VIX', '^VIX9D', '^SKEW'];
                const baseUrl = 'https://query1.finance.yahoo.com/v8/finance/chart/';
                
                // Fetch VIX
                const vixResponse = await fetch(`${baseUrl}^VIX`);
                const vixData = await vixResponse.json();
                marketData.vix = vixData.chart.result[0].meta.regularMarketPrice || 
                                 vixData.chart.result[0].meta.previousClose || 18.5;
                
                // For demo purposes, simulate other data
                // In production, you'd fetch these from actual sources
                marketData.vix9d = marketData.vix * (1.05 + Math.random() * 0.15);
                marketData.skew = 120 + Math.random() * 35;
                marketData.pcRatio = 0.8 + Math.random() * 0.6;
                marketData.tick = -500 + Math.random() * 1000;
                marketData.trin = 0.9 + Math.random() * 0.8;
                marketData.dix = 0.35 + Math.random() * 0.15;
                marketData.hygLqd = 1.02 + Math.random() * 0.08;
                marketData.advDecline = 0.3 + Math.random() * 0.4;
                
                // Calculate derived metrics
                marketData.vix9dRatio = marketData.vix9d / marketData.vix;
                
                updateDashboard();
                
            } catch (error) {
                console.error('Error fetching data:', error);
                // Use fallback/demo data
                useDemoData();
            }
        }
        
        // Fallback demo data
        function useDemoData() {
            marketData = {
                vix: 18.5 + Math.random() * 4,
                vix9d: 20.1 + Math.random() * 3,
                skew: 125 + Math.random() * 30,
                pcRatio: 0.95 + Math.random() * 0.5,
                tick: -200 + Math.random() * 800,
                trin: 1.1 + Math.random() * 0.8,
                dix: 0.40 + Math.random() * 0.1,
                hygLqd: 1.04 + Math.random() * 0.04,
                advDecline: 0.45 + Math.random() * 0.2
            };
            marketData.vix9dRatio = marketData.vix9d / marketData.vix;
            updateDashboard();
        }
        
        // Create metric cards
        function createMetricCards() {
            const metrics = [
                { key: 'vix', title: 'VIX Index', tier: 1, format: '.2f' },
                { key: 'vix9dRatio', title: 'VIX9D/VIX Ratio', tier: 1, format: '.3f' },
                { key: 'skew', title: 'SKEW Index', tier: 1, format: '.1f' },
                { key: 'pcRatio', title: 'Put/Call Ratio', tier: 2, format: '.3f' },
                { key: 'tick', title: 'NYSE TICK', tier: 2, format: '.0f' },
                { key: 'trin', title: 'TRIN (Arms Index)', tier: 2, format: '.2f' },
                { key: 'dix', title: 'Dark Index (DIX)', tier: 3, format: '.3f' },
                { key: 'hygLqd', title: 'HYG/LQD Spread', tier: 2, format: '.3f' },
                { key: 'advDecline', title: 'Advance/Decline', tier: 2, format: '.1%' }
            ];
            
            const grid = document.getElementById('metricsGrid');
            grid.innerHTML = metrics.map(m => `
                <div class="metric-card" id="card-${m.key}">
                    <div class="metric-header">
                        <div class="metric-title">${m.title}</div>
                        <div class="metric-tier tier-${m.tier}">TIER ${m.tier}</div>
                    </div>
                    <div class="metric-value" id="value-${m.key}">--</div>
                    <div class="metric-status status-normal" id="status-${m.key}">Loading...</div>
                </div>
            `).join('');
        }
        
        // Update dashboard with current data
        function updateDashboard() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
            
            // Check market hours
            const hour = now.getHours();
            const day = now.getDay();
            const isMarketOpen = hour >= 9 && hour < 16 && day > 0 && day < 6;
            document.getElementById('marketStatus').textContent = 
                isMarketOpen ? 'üü¢ Market Open' : 'üî¥ Market Closed';
            
            // Reset alerts
            alerts = [];
            let activeSignals = 0;
            let tier1Signals = 0;
            let tier2Signals = 0;
            
            // Update VIX
            const vixEl = document.getElementById('value-vix');
            const vixStatus = document.getElementById('status-vix');
            const vixCard = document.getElementById('card-vix');
            if (vixEl && marketData.vix) {
                vixEl.textContent = marketData.vix.toFixed(2);
                vixCard.classList.remove('triggered');
                
                if (marketData.vix > THRESHOLDS.vix.critical) {
                    vixStatus.textContent = 'CRITICAL >30';
                    vixStatus.className = 'metric-status status-triggered';
                    vixCard.classList.add('triggered');
                    alerts.push('üö® VIX CRITICAL: ' + marketData.vix.toFixed(2));
                } else if (marketData.vix > THRESHOLDS.vix.elevated) {
                    vixStatus.textContent = 'ELEVATED >25';
                    vixStatus.className = 'metric-status status-warning';
                } else if (marketData.vix > THRESHOLDS.vix.warning) {
                    vixStatus.textContent = 'WARNING >20';
                    vixStatus.className = 'metric-status status-warning';
                } else {
                    vixStatus.textContent = 'Normal Range';
                    vixStatus.className = 'metric-status status-normal';
                }
            }
            
            // Update VIX9D/VIX Ratio
            const vix9dEl = document.getElementById('value-vix9dRatio');
            const vix9dStatus = document.getElementById('status-vix9dRatio');
            const vix9dCard = document.getElementById('card-vix9dRatio');
            if (vix9dEl && marketData.vix9dRatio) {
                vix9dEl.textContent = marketData.vix9dRatio.toFixed(3);
                vix9dCard.classList.remove('triggered');
                
                if (marketData.vix9dRatio > THRESHOLDS.vix9dRatio.signal) {
                    vix9dStatus.textContent = 'SIGNAL TRIGGERED >1.10';
                    vix9dStatus.className = 'metric-status status-triggered';
                    vix9dCard.classList.add('triggered');
                    tier1Signals++;
                    activeSignals++;
                    alerts.push('‚ö° VIX9D/VIX Ratio: ' + marketData.vix9dRatio.toFixed(3));
                } else {
                    vix9dStatus.textContent = 'Normal (0.80-1.20)';
                    vix9dStatus.className = 'metric-status status-normal';
                }
            }
            
            // Update SKEW
            const skewEl = document.getElementById('value-skew');
            const skewStatus = document.getElementById('status-skew');
            const skewCard = document.getElementById('card-skew');
            if (skewEl && marketData.skew) {
                skewEl.textContent = marketData.skew.toFixed(1);
                skewCard.classList.remove('triggered');
                
                if (marketData.skew > THRESHOLDS.skew.critical) {
                    skewStatus.textContent = 'CRITICAL >150';
                    skewStatus.className = 'metric-status status-triggered';
                    skewCard.classList.add('triggered');
                    tier1Signals++;
                    activeSignals++;
                    alerts.push('‚ö†Ô∏è SKEW Critical: ' + marketData.skew.toFixed(1));
                } else if (marketData.skew > THRESHOLDS.skew.warning) {
                    skewStatus.textContent = 'WARNING >145';
                    skewStatus.className = 'metric-status status-warning';
                    tier1Signals++;
                    activeSignals++;
                } else {
                    skewStatus.textContent = 'Normal (100-130)';
                    skewStatus.className = 'metric-status status-normal';
                }
            }
            
            // Update Put/Call Ratio
            const pcEl = document.getElementById('value-pcRatio');
            const pcStatus = document.getElementById('status-pcRatio');
            const pcCard = document.getElementById('card-pcRatio');
            if (pcEl && marketData.pcRatio) {
                pcEl.textContent = marketData.pcRatio.toFixed(3);
                pcCard.classList.remove('triggered');
                
                if (marketData.pcRatio > THRESHOLDS.pcRatio.fear) {
                    pcStatus.textContent = 'FEAR >1.23';
                    pcStatus.className = 'metric-status status-triggered';
                    pcCard.classList.add('triggered');
                    tier2Signals++;
                    activeSignals++;
                    alerts.push('üìä Put/Call Fear: ' + marketData.pcRatio.toFixed(3));
                } else if (marketData.pcRatio < THRESHOLDS.pcRatio.greed) {
                    pcStatus.textContent = 'GREED <0.72';
                    pcStatus.className = 'metric-status status-warning';
                } else {
                    pcStatus.textContent = 'Normal (0.7-1.2)';
                    pcStatus.className = 'metric-status status-normal';
                }
            }
            
            // Update other metrics similarly
            updateMetric('tick', marketData.tick, 
                v => v < THRESHOLDS.tick.signal, 
                'SIGNAL <-1000', 'Normal (-300 to 200)', () => { tier2Signals++; activeSignals++; });
            
            updateMetric('trin', marketData.trin,
                v => v > THRESHOLDS.trin.signal,
                'SIGNAL >2.0', 'Normal (0.8-1.2)', () => { tier2Signals++; activeSignals++; });
            
            updateMetric('dix', marketData.dix,
                v => v < THRESHOLDS.dix.bearish,
                'BEARISH <0.35', 'Normal (0.35-0.45)', () => { activeSignals++; });
            
            updateMetric('hygLqd', marketData.hygLqd,
                v => v > THRESHOLDS.hygLqd.warning,
                'WARNING >1.06', 'Normal <1.06', () => { tier2Signals++; activeSignals++; });
            
            updateMetric('advDecline', marketData.advDecline,
                v => v < THRESHOLDS.advDecline.signal,
                'SIGNAL <30%', 'Normal (40-60%)', () => { tier2Signals++; activeSignals++; },
                '.1%');
            
            // Update main signal
            document.getElementById('activeCount').textContent = activeSignals;
            
            let signalText = 'WAIT FOR SIGNALS';
            let signalClass = 'signal-wait';
            let confluenceLevel = 'LOW';
            
            if (tier1Signals >= 2 && tier2Signals >= 1) {
                signalText = 'üöÄ ENTER POSITION';
                signalClass = 'signal-enter';
                confluenceLevel = 'HIGH';
                alerts.unshift('üéØ CONFLUENCE HIGH - ENTER TRADE');
            } else if (tier1Signals >= 1 && tier2Signals >= 1) {
                signalText = '‚ö° PREPARE ENTRY';
                signalClass = 'signal-prepare';
                confluenceLevel = 'MEDIUM';
            }
            
            const mainSignal = document.getElementById('mainSignal');
            mainSignal.textContent = signalText;
            mainSignal.className = 'signal-status ' + signalClass;
            document.getElementById('confluenceLevel').textContent = confluenceLevel;
            
            // Update alerts list
            const alertsList = document.getElementById('alertsList');
            if (alerts.length === 0) {
                alertsList.innerHTML = `
                    <div class="alert-item">
                        <div class="alert-icon">‚úÖ</div>
                        <div>All metrics within normal ranges</div>
                    </div>
                `;
            } else {
                alertsList.innerHTML = alerts.map(alert => `
                    <div class="alert-item">
                        <div class="alert-icon">${alert.substring(0, 2)}</div>
                        <div>${alert.substring(2)}</div>
                    </div>
                `).join('');
            }
        }
        
        // Helper function to update metrics
        function updateMetric(key, value, triggerCondition, triggerText, normalText, onTrigger, format = '.2f') {
            const el = document.getElementById(`value-${key}`);
            const status = document.getElementById(`status-${key}`);
            const card = document.getElementById(`card-${key}`);
            
            if (el && value !== undefined) {
                if (format === '.1%') {
                    el.textContent = (value * 100).toFixed(1) + '%';
                } else if (format === '.0f') {
                    el.textContent = Math.round(value);
                } else if (format === '.3f') {
                    el.textContent = value.toFixed(3);
                } else if (format === '.1f') {
                    el.textContent = value.toFixed(1);
                } else {
                    el.textContent = value.toFixed(2);
                }
                
                card.classList.remove('triggered');
                
                if (triggerCondition(value)) {
                    status.textContent = triggerText;
                    status.className = 'metric-status status-triggered';
                    card.classList.add('triggered');
                    if (onTrigger) onTrigger();
                } else {
                    status.textContent = normalText;
                    status.className = 'metric-status status-normal';
                }
            }
        }
        
        // Countdown timer
        function updateCountdown() {
            refreshTimer--;
            if (refreshTimer <= 0) {
                refreshTimer = 60;
                fetchMarketData();
            }
            document.getElementById('refreshCountdown').textContent = refreshTimer + 's';
        }
        
        // Initialize
        function init() {
            createMetricCards();
            fetchMarketData();
            setInterval(updateCountdown, 1000);
        }
        
        // Start the dashboard
        init();
    </script>
</body>
</html>
